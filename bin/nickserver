#!/usr/bin/ruby

#
# Nickserver key discovery daemon
#

#
# bootstrap nickserver library
#
begin                      # try without rubygems (might be already loaded or not present)
  require 'nickserver'
rescue LoadError
  begin                    # try with rubygems
    require 'rubygems'
    require 'nickserver'
  rescue LoadError         # try manually
    BASE_DIR = File.expand_path('../..', File.symlink?(__FILE__) ? File.readlink(__FILE__) : __FILE__)
    $LOAD_PATH << "#{BASE_DIR}/lib"
    require "nickserver"
  end
end

Nickserver::Daemon.run do
  EventMachine.run do
    Nickserver::Server.start
  end
end